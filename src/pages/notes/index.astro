---
import Layout from '@/layouts/Layout.astro';
import ThemeToggle from '@/components/theme-toggle.tsx';
import { FadeIn } from '@/components/motion/FadeIn.tsx';
import { getCollection } from 'astro:content';

const posts = await getCollection('notes');
---
<Layout title='Notes Â· Nikita Lobanov' description='Build logs and notes on Go, TypeScript, tooling, and lessons from production.'>
	<header class='sticky top-0 z-30 border-b border-border/60 bg-background/80 backdrop-blur'>
		<div class='container flex items-center justify-between py-4 text-sm'>
				<a href='/' class='flex items-center gap-2 text-muted-foreground transition-colors hover:text-foreground'>
					<img src='/logo.svg' alt='Nikita Lobanov logo' class='h-6 w-6' loading='lazy' />
					<span class='font-mono text-xs tracking-[0.3em]'>NIKITA</span>
				</a>
			<ThemeToggle client:load />
		</div>
	</header>
	<main class='container space-y-10 py-20'>
		<div class='space-y-4'>
			<h1 class='text-4xl font-mono tracking-tight md:text-5xl'>Notes & build logs</h1>
			<p class='max-w-2xl text-muted-foreground'>Short, direct posts covering Go vs TypeScript tradeoffs, Neovim workflows, PostgreSQL lessons, and why this site now runs on Astro.</p>
		</div>
		<div class='space-y-4'>
			{posts.length === 0 ? (
				<p class='rounded-md border border-border/60 bg-background/70 p-6 text-sm text-muted-foreground'>First entries are in draft. Expect the topics listed on the homepage soon.</p>
			) : (
				posts
					.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
					.map((post, index) => (
						<FadeIn key={post.id} client:visible delay={index * 0.05} className='rounded-lg border border-border/60 bg-background/60 p-6'>
							<a href={`/notes/${post.slug}/`} class='space-y-2 transition-colors hover:text-foreground'>
								<p class='text-xs uppercase tracking-[0.18em] text-muted-foreground/70'>{post.data.publishDate.toLocaleDateString()}</p>
								<h2 class='text-2xl font-mono'>{post.data.title}</h2>
								<p class='text-sm text-muted-foreground'>{post.data.description}</p>
								{post.data.tags && (
									<ul class='flex flex-wrap gap-2 pt-2 text-xs text-muted-foreground'>
										{post.data.tags.map(tag => (
											<li key={tag} class='rounded-full border border-border/60 px-3 py-1'>#{tag}</li>
										))}
									</ul>
								)}
							</a>
						</FadeIn>
					))
			)}
		</div>
	</main>
</Layout>
